# Weather Agent with Generative UI

åŸºäº LangGraph æ„å»ºçš„æ™ºèƒ½å¤©æ°” Agentï¼Œå…·å¤‡ Generative UI åŠŸèƒ½ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€äº¤äº’å’ŒåŠ¨æ€ React ç»„ä»¶ç”Ÿæˆã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- âœ… **æ™ºèƒ½è‡ªç„¶è¯­è¨€å¤„ç†** - ä¼˜åŒ–çš„ä¸¤å±‚åŸå¸‚æå–ç®—æ³•ï¼Œæ”¯æŒå¤æ‚è‡ªç„¶è¯­è¨€è¡¨è¾¾
- âœ… **åŠ¨æ€ UI ç”Ÿæˆ** - åç«¯åŠ¨æ€ç”Ÿæˆå¸¦åŠ¨ç”»æ•ˆæœçš„ React å¤©æ°”å¡ç‰‡ç»„ä»¶
- âœ… **å¤šç§è¡¨è¾¾æ”¯æŒ** - æ”¯æŒç›´æ¥æŸ¥è¯¢ã€è¯¢é—®æ¨¡å¼ã€æŸ¥è¯¢æ¨¡å¼ã€æ—¶é—´æ¨¡å¼ç­‰
- âœ… **æ—  LLM ä¾èµ–** - ä½¿ç”¨é™æ€æ•°æ®å’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œå“åº”é€Ÿåº¦å¿«
- âœ… **å“åº”å¼è®¾è®¡** - ç°ä»£åŒ–UIè®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯é€‚é…
- âœ… **å®Œæ•´æµ‹è¯•è¦†ç›–** - 34ä¸ªå•å…ƒæµ‹è¯•ï¼Œ100%é€šè¿‡ç‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
# ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
uv sync --group dev

# æˆ–ä½¿ç”¨ pip
pip install -e . "langgraph-cli[inmem]"

# Python ç‰ˆæœ¬è¦æ±‚
uv python pin 3.11
```

### è¿è¡Œæ¼”ç¤º
```bash
# æŸ¥çœ‹åŠŸèƒ½æ¼”ç¤º
uv run python examples/weather_demo.py

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
uv run langgraph dev
```

### åŸºæœ¬ä½¿ç”¨
```python
from langchain_core.messages import HumanMessage
from agent.graph import graph, AgentState

# åˆ›å»ºç”¨æˆ·æŸ¥è¯¢
state = AgentState(
    messages=[HumanMessage(content="åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ")],
    ui=[]
)

# è°ƒç”¨ agent
result = await graph.ainvoke(state, {"configurable": {}})

# è·å–ç»“æœ
ai_message = result["messages"][-1].content  # AI å›å¤ "â˜€ï¸ ä»Šå¤©åŒ—äº¬å¤©æ°”æ™´æœ—..."
ui_data = result["ui"][-1]["props"]          # UI ç»„ä»¶æ•°æ® {"city": "åŒ—äº¬", ...}
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ src/agent/                    # æ ¸å¿ƒ Agent ä»£ç 
â”‚   â”œâ”€â”€ graph.py                  # ä¸»è¦ graph å®šä¹‰å’Œå¤©æ°”èŠ‚ç‚¹
â”‚   â”œâ”€â”€ ui.tsx                    # React UI ç»„ä»¶ï¼ˆå¸¦åŠ¨ç”»æ•ˆæœï¼‰
â”‚   â””â”€â”€ __init__.py               # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ tests/                        # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ unit_tests/               # 34ä¸ªå•å…ƒæµ‹è¯• (100% é€šè¿‡)
â”‚   â”‚   â”œâ”€â”€ test_message_parsing.py    # è‡ªç„¶è¯­è¨€è§£ææµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_weather_node.py       # å¤©æ°”èŠ‚ç‚¹åŠŸèƒ½æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_ui_data.py            # UIç»„ä»¶æ•°æ®æµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_configuration.py      # é…ç½®ç»“æ„æµ‹è¯•
â”‚   â””â”€â”€ integration_tests/        # é›†æˆæµ‹è¯•
â”œâ”€â”€ examples/                     # ç¤ºä¾‹å’Œæ¼”ç¤º
â”‚   â””â”€â”€ weather_demo.py           # å®Œæ•´åŠŸèƒ½æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ development/              # å¼€å‘æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ ARCHITECTURE.md       # æŠ€æœ¯æ¶æ„æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ README.md             # å¼€å‘æ–‡æ¡£å¯¼èˆª
â”‚   â”œâ”€â”€ features/                 # åŠŸèƒ½æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ generative-ui-guide.md
â”‚   â”‚   â””â”€â”€ message-parsing.md
â”‚   â””â”€â”€ testing/                  # æµ‹è¯•æ–‡æ¡£
â”‚       â””â”€â”€ test-structure.md
â”œâ”€â”€ CLAUDE.md                     # é¡¹ç›®æŒ‡å¯¼æ–‡ä»¶
â”œâ”€â”€ langgraph.json                # LangGraph é…ç½®
â”œâ”€â”€ pyproject.toml                # Python é¡¹ç›®é…ç½®
â”œâ”€â”€ Makefile                      # æ™ºèƒ½å·¥å…·é€‰æ‹©
â””â”€â”€ .python-version               # Python ç‰ˆæœ¬é”å®š (3.11)
```

## ğŸ’¬ æ”¯æŒçš„æŸ¥è¯¢æ–¹å¼

### ğŸ¯ ä¼˜åŒ–çš„ä¸¤å±‚åŸå¸‚æå–ç®—æ³•

**ç¬¬ä¸€å±‚ï¼šç›´æ¥åŒ¹é…ï¼ˆæ€§èƒ½æœ€ä¼˜ï¼‰**
- "åŒ—äº¬å¤©æ°”" â†’ ç›´æ¥è¯†åˆ« "åŒ—äº¬"
- "ä¸Šæµ·çš„æ¸©åº¦" â†’ ç›´æ¥è¯†åˆ« "ä¸Šæµ·"  
- "æ·±åœ³" â†’ ç›´æ¥è¯†åˆ« "æ·±åœ³"

**ç¬¬äºŒå±‚ï¼šæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…ï¼ˆæ”¯æŒå¤æ‚è‡ªç„¶è¯­è¨€ï¼‰**

### æŸ¥è¯¢æ¨¡å¼
- "æŸ¥è¯¢åŒ—äº¬çš„å¤©æ°”"
- "æŸ¥çœ‹ä¸Šæµ·å¤©æ°”"
- "äº†è§£æ·±åœ³çš„æ¸©åº¦"
- "çŸ¥é“å¹¿å·å¤©æ°”"

### è¯¢é—®æ¨¡å¼  
- "åŒ—äº¬çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
- "ä¸Šæµ·å¤©æ°”å¦‚ä½•ï¼Ÿ"
- "æ·±åœ³çš„æ¸©åº¦æ€æ ·ï¼Ÿ"
- "å¹¿å·å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"

### æ—¶é—´è¡¨è¾¾æ¨¡å¼
- "ä»Šå¤©åŒ—äº¬å¤©æ°”"
- "æ˜å¤©ä¸Šæµ·çš„æ¸©åº¦" 
- "ç°åœ¨æ·±åœ³å¤©æ°”"

### å¤æ‚è‡ªç„¶è¯­è¨€è¡¨è¾¾
- "æˆ‘æƒ³çŸ¥é“åŒ—äº¬ä»Šå¤©çš„å¤©æ°”æƒ…å†µ"
- "è¯·å‘Šè¯‰æˆ‘ä¸Šæµ·çš„å¤©æ°”é¢„æŠ¥"
- "èƒ½å¸®æˆ‘æŸ¥ä¸€ä¸‹æ·±åœ³çš„å¤©æ°”å—"

## ğŸ§ª æµ‹è¯•

### ğŸ“Š æµ‹è¯•è¦†ç›– (34/34 é€šè¿‡, 100%)
- **æ¶ˆæ¯è§£æ**: 10ä¸ªæµ‹è¯• - è‡ªç„¶è¯­è¨€æ¨¡å¼è¯†åˆ«
- **å¤©æ°”èŠ‚ç‚¹**: 8ä¸ªæµ‹è¯• - å¼‚æ­¥åŠŸèƒ½å’Œé”™è¯¯å¤„ç†  
- **UIæ•°æ®**: 12ä¸ªæµ‹è¯• - ç»„ä»¶æ•°æ®ç»“æ„éªŒè¯
- **é…ç½®**: 4ä¸ªæµ‹è¯• - å›¾ç»“æ„å’Œè®¾ç½®

### ğŸ”§ è¿è¡Œæµ‹è¯•
```bash
# ä½¿ç”¨ make å‘½ä»¤ï¼ˆæ¨èï¼Œè‡ªåŠ¨ä¼˜å…ˆä½¿ç”¨ uvï¼‰
make test                    # è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
make integration_tests       # è¿è¡Œé›†æˆæµ‹è¯•
make test_watch             # ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•

# ä»£ç è´¨é‡æ£€æŸ¥
make format                  # ä»£ç æ ¼å¼åŒ–
make lint                    # ä»£ç æ£€æŸ¥

# ç›´æ¥ä½¿ç”¨ uv æˆ– python
uv run pytest tests/unit_tests/ -v          # ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
python -m pytest tests/unit_tests/ -v       # ä½¿ç”¨ python
```

## ğŸ¨ UI ç»„ä»¶

### ğŸ­ åŠ¨æ€å¤©æ°”å¡ç‰‡ç»„ä»¶
å¤©æ°” agent ç”Ÿæˆçš„ UI ç»„ä»¶åŒ…å«ï¼š
- ğŸ“ **åŸå¸‚åç§°** - æ”¯æŒçš„5ä¸ªä¸­å›½åŸå¸‚
- ğŸŒ¡ï¸ **æ¸©åº¦ä¿¡æ¯** - ç²¾å‡†çš„æ¸©åº¦æ˜¾ç¤º (å¦‚ï¼š22Â°C)
- â˜ï¸ **å¤©æ°”çŠ¶å†µ** - åŠ¨æ€å›¾æ ‡æ˜ å°„ (â˜€ï¸æ™´å¤© â›…å¤šäº‘ ğŸŒ§ï¸å°é›¨)
- ğŸ’§ **æ¹¿åº¦æ•°æ®** - ç™¾åˆ†æ¯”æ˜¾ç¤º (å¦‚ï¼š45%)
- ğŸ’¨ **é£é€Ÿä¿¡æ¯** - ç»Ÿä¸€windSpeedå­—æ®µ (å¦‚ï¼š3km/h)
- ğŸ“ **å¤©æ°”æè¿°** - è´´å¿ƒçš„ç”Ÿæ´»å»ºè®®

### âœ¨ UI ç‰¹æ€§
- **åŠ¨ç”»æ•ˆæœ**: å¡ç‰‡å…¥åœºåŠ¨ç”»ã€å›¾æ ‡å¼¹è·³ã€é—ªçƒç‰¹æ•ˆ
- **å“åº”å¼è®¾è®¡**: ç§»åŠ¨ç«¯é€‚é…ï¼Œè‡ªåŠ¨ç¼©æ”¾
- **èƒŒæ™¯æ¸å˜**: æ ¹æ®å¤©æ°”çŠ¶å†µåŠ¨æ€è°ƒæ•´èƒŒæ™¯è‰²
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptæ¥å£å®šä¹‰

### ğŸ“± å‰ç«¯é›†æˆ
```tsx
import { LoadExternalComponent } from "@langchain/langgraph-sdk/react-ui";

<LoadExternalComponent 
  stream={thread} 
  message={ui} 
  fallback={<div>Loading weather...</div>} 
/>
```

### ğŸ”§ æ•°æ®ç»“æ„
```typescript
interface WeatherProps {
  city: string;           // åŸå¸‚åç§°
  temperature: string;    // æ¸©åº¦ "22Â°C"
  condition: string;      // å¤©æ°”çŠ¶å†µ "æ™´å¤©"
  humidity: string;       // æ¹¿åº¦ "45%"
  windSpeed: string;      // é£é€Ÿ "3km/h" 
  description: string;    // è¯¦ç»†æè¿°
}
```

## ğŸ“Š æ”¯æŒçš„åŸå¸‚

å½“å‰æ”¯æŒä»¥ä¸‹**5ä¸ªä¸­å›½åŸå¸‚**çš„å¤©æ°”æŸ¥è¯¢ï¼š

| åŸå¸‚ | å¤©æ°”çŠ¶å†µ | æ¸©åº¦ | æ¹¿åº¦ | é£é€Ÿ | ç‰¹è‰²æè¿° |
|------|----------|------|------|------|----------|
| åŒ—äº¬ | æ™´å¤© â˜€ï¸ | 22Â°C | 45% | 3km/h | å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦é€‚å®œï¼Œé€‚åˆå¤–å‡ºæ´»åŠ¨ |
| ä¸Šæµ· | å¤šäº‘ â›… | 18Â°C | 68% | 5km/h | å¤šäº‘è½¬é˜´ï¼Œæ¸©åº¦ç¨å‡‰ï¼Œå»ºè®®å¢æ·»è¡£ç‰© |
| æ·±åœ³ | å°é›¨ ğŸŒ§ï¸ | 26Â°C | 78% | 7km/h | æœ‰å°é›¨ï¼Œæ¹¿åº¦è¾ƒé«˜ï¼Œå‡ºé—¨è®°å¾—å¸¦ä¼ |
| å¹¿å· | é˜´å¤© â˜ï¸ | 24Â°C | 72% | 4km/h | é˜´å¤©ï¼Œæ¸©åº¦èˆ’é€‚ï¼Œé€‚åˆå®¤å†…æ´»åŠ¨ |
| æ­å· | æ™´å¤© â˜€ï¸ | 20Â°C | 55% | 6km/h | æ™´ç©ºä¸‡é‡Œï¼Œæ¸©åº¦å®œäººï¼Œæ˜¯æ¸¸è§ˆçš„å¥½å¤©æ°” |

### ğŸ”„ å®¹é”™å¤„ç†
- **ä¸æ”¯æŒçš„åŸå¸‚**: è‡ªåŠ¨å›é€€åˆ°é»˜è®¤åŸå¸‚ï¼ˆåŒ—äº¬ï¼‰
- **æ— åŸå¸‚æŒ‡å®š**: é»˜è®¤æ˜¾ç¤ºåŒ—äº¬å¤©æ°”
- **å¤šåŸå¸‚åŒæ—¶å‡ºç°**: è¿”å›æ¶ˆæ¯ä¸­æœ€å…ˆå‡ºç°çš„åŸå¸‚

## ğŸ”§ æŠ€æœ¯é…ç½®

### LangGraph é…ç½® (langgraph.json)
```json
{
  "graphs": {
    "agent": "./src/agent/graph.py:graph"
  },
  "ui": {
    "agent": "./src/agent/ui.tsx"
  }
}
```

### Python é…ç½® (pyproject.toml)
```toml
[project]
requires-python = ">=3.11"
dependencies = [
    "langgraph>=0.2.6", 
    "langchain-core>=0.3.0"
]

[tool.uv.dev-dependencies]
pytest = ">=8.3.5"
mypy = ">=1.13.0"
ruff = ">=0.8.2"
```

### æ™ºèƒ½ Makefile
```makefile
PYTHON_CMD := $(shell command -v uv >/dev/null 2>&1 && echo "uv run" || echo "python -m")
```
è‡ªåŠ¨é€‰æ‹© `uv` æˆ– `python` å‘½ä»¤ï¼Œä¼˜å…ˆä½¿ç”¨æ€§èƒ½æ›´å¥½çš„ `uv`ã€‚

## ğŸ“š è¯¦ç»†æ–‡æ¡£

### ğŸ—ï¸ å¼€å‘æ–‡æ¡£
- [æŠ€æœ¯æ¶æ„æ–‡æ¡£](docs/development/ARCHITECTURE.md) - å®Œæ•´çš„ç³»ç»Ÿæ¶æ„å’ŒæŠ€æœ¯å®ç°è¯¦è§£

### âœ¨ åŠŸèƒ½æ–‡æ¡£  
- [Generative UI åŠŸèƒ½æŒ‡å—](docs/features/generative-ui-guide.md) - è¯¦ç»†çš„ UI ç»„ä»¶å¼€å‘æŒ‡å—
- [æ¶ˆæ¯è§£æåŠŸèƒ½](docs/features/message-parsing.md) - è‡ªç„¶è¯­è¨€å¤„ç†å®ç°è¯¦è§£

### ğŸ§ª æµ‹è¯•æ–‡æ¡£
- [æµ‹è¯•ç»“æ„æ–‡æ¡£](docs/testing/test-structure.md) - æµ‹è¯•å¥—ä»¶ç»“æ„å’Œä½¿ç”¨è¯´æ˜

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ğŸ™ï¸ æ·»åŠ æ–°åŸå¸‚
1. åœ¨ `src/agent/graph.py` çš„ `WEATHER_DATA` æ•°ç»„ä¸­æ·»åŠ åŸå¸‚æ•°æ®
2. ç¡®ä¿åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼š`city`, `temperature`, `condition`, `humidity`, `windSpeed`, `description`
3. æ›´æ–°ç›¸å…³æµ‹è¯•ç”¨ä¾‹ï¼ˆ`test_ui_data.py`, `test_weather_node.py`ï¼‰
4. è¿è¡Œ `make test` éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡

### ğŸ§  æ‰©å±•è‡ªç„¶è¯­è¨€æ¨¡å¼
1. åœ¨ `extract_city_from_message()` å‡½æ•°çš„ `basic_patterns` æ•°ç»„ä¸­æ·»åŠ æ–°çš„æ­£åˆ™è¡¨è¾¾å¼
2. åœ¨ `test_message_parsing.py` ä¸­æ·»åŠ å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹
3. ä½¿ç”¨ `uv run python examples/weather_demo.py` éªŒè¯åŠŸèƒ½
4. ç¡®ä¿å‘åå…¼å®¹æ€§ï¼Œä¸ç ´åç°æœ‰æ¨¡å¼

### ğŸ¨ è‡ªå®šä¹‰ UI ç»„ä»¶
1. ä¿®æ”¹ `src/agent/ui.tsx` ä¸­çš„ `WeatherComponent`
2. æ›´æ–° `WeatherProps` æ¥å£å®šä¹‰ï¼ˆå¦‚éœ€è¦ï¼‰
3. ä½¿ç”¨å†…è”æ ·å¼æˆ–æ‰©å±•ç°æœ‰åŠ¨ç”»æ•ˆæœ
4. ä¿æŒä¸åç«¯ `WeatherOutput` æ•°æ®ç»“æ„çš„ä¸€è‡´æ€§
5. åœ¨ç§»åŠ¨ç«¯æµ‹è¯•å“åº”å¼å¸ƒå±€

### ğŸ“Š æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥
```bash
# æ£€æŸ¥å‰åç«¯æ•°æ®ç»“æ„ä¸€è‡´æ€§
make test  # UIæ•°æ®æµ‹è¯•ä¼šéªŒè¯å­—æ®µåŒ¹é…
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. è¿è¡Œæµ‹è¯•ç¡®ä¿é€šè¿‡
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ LICENSE æ–‡ä»¶

## ğŸ™‹â€â™‚ï¸ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ–‡æ¡£ç›®å½•ä¸­çš„è¯¦ç»†æŒ‡å—
2. è¿è¡Œç¤ºä¾‹è„šæœ¬äº†è§£ç”¨æ³•
3. æŸ¥çœ‹æµ‹è¯•ç”¨ä¾‹ä½œä¸ºå‚è€ƒ
4. æäº¤ Issue åé¦ˆé—®é¢˜

---

**å¼€å§‹ä½¿ç”¨**: `uv run python examples/weather_demo.py` ğŸš€
